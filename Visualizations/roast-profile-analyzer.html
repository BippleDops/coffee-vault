<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roast Profile Analyzer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0a0605 0%, #2B1810 100%);
            color: #FFF8E1;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5rem;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            text-align: center;
            margin-bottom: 30px;
            color: #D4A574;
            font-size: 1.1rem;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            margin-bottom: 30px;
        }

        #roast-canvas {
            width: 100%;
            height: auto;
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .control-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .control-title {
            color: #FFD700;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .roast-presets {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .preset-btn {
            flex: 1;
            min-width: 100px;
            padding: 10px;
            background: rgba(255, 215, 0, 0.2);
            border: 2px solid rgba(255, 215, 0, 0.3);
            color: #FFF8E1;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .preset-btn:hover,
        .preset-btn.active {
            background: rgba(255, 215, 0, 0.4);
            border-color: #FFD700;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .metric-card {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid;
        }

        .metric-card.temp { border-left-color: #FF5722; }
        .metric-card.time { border-left-color: #2196F3; }
        .metric-card.ror { border-left-color: #4CAF50; }
        .metric-card.color { border-left-color: #9C27B0; }

        .metric-label {
            font-size: 0.8rem;
            color: #D4A574;
            margin-bottom: 5px;
            text-transform: uppercase;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #FFD700;
        }

        .phase-markers {
            margin-top: 20px;
        }

        .phase-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 8px;
        }

        .phase-name {
            font-weight: bold;
            color: #FFD700;
        }

        .phase-time {
            color: #FFF8E1;
        }

        .analysis-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .analysis-title {
            color: #FFD700;
            font-size: 1.3rem;
            margin-bottom: 15px;
        }

        .flavor-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .flavor-tag {
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid rgba(255, 215, 0, 0.3);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .recommendation-list {
            list-style: none;
        }

        .recommendation-item {
            padding: 12px;
            margin-bottom: 10px;
            background: rgba(255, 215, 0, 0.1);
            border-left: 4px solid #FFD700;
            border-radius: 6px;
            line-height: 1.5;
        }

        .comparison-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .compare-btn {
            background: rgba(76, 175, 80, 0.3);
            border: 2px solid #4CAF50;
            color: #4CAF50;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .compare-btn:hover {
            background: #4CAF50;
            color: #FFF;
        }

        @media (max-width: 768px) {
            .controls-grid {
                grid-template-columns: 1fr;
            }

            .metrics-grid {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>â˜• Roast Profile Analyzer</h1>
        <p class="subtitle">Visualize and analyze coffee roasting curves</p>

        <div class="controls-grid">
            <div class="control-card">
                <div class="control-title">Roast Level Presets</div>
                <div class="roast-presets">
                    <button class="preset-btn" data-roast="light">Light</button>
                    <button class="preset-btn active" data-roast="medium-light">Med-Light</button>
                    <button class="preset-btn" data-roast="medium">Medium</button>
                    <button class="preset-btn" data-roast="medium-dark">Med-Dark</button>
                    <button class="preset-btn" data-roast="dark">Dark</button>
                </div>

                <div class="metrics-grid">
                    <div class="metric-card temp">
                        <div class="metric-label">End Temp</div>
                        <div class="metric-value" id="end-temp">210Â°C</div>
                    </div>
                    <div class="metric-card time">
                        <div class="metric-label">Total Time</div>
                        <div class="metric-value" id="total-time">11:30</div>
                    </div>
                    <div class="metric-card ror">
                        <div class="metric-label">Avg ROR</div>
                        <div class="metric-value" id="avg-ror">12Â°/min</div>
                    </div>
                    <div class="metric-card color">
                        <div class="metric-label">Agtron</div>
                        <div class="metric-value" id="agtron">65</div>
                    </div>
                </div>
            </div>

            <div class="control-card">
                <div class="control-title">Roast Phases</div>
                <div class="phase-markers">
                    <div class="phase-row">
                        <span class="phase-name">ðŸ”¥ Drying Phase</span>
                        <span class="phase-time" id="drying-time">0:00 - 4:00</span>
                    </div>
                    <div class="phase-row">
                        <span class="phase-name">ðŸŒ° Maillard Phase</span>
                        <span class="phase-time" id="maillard-time">4:00 - 8:00</span>
                    </div>
                    <div class="phase-row">
                        <span class="phase-name">ðŸ’¥ First Crack</span>
                        <span class="phase-time" id="fc-time">8:30</span>
                    </div>
                    <div class="phase-row">
                        <span class="phase-name">ðŸš€ Development</span>
                        <span class="phase-time" id="dev-time">8:30 - 11:30</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="chart-container">
            <canvas id="roast-canvas" width="1200" height="600"></canvas>
        </div>

        <div class="analysis-section">
            <h3 class="analysis-title">Flavor Profile & Recommendations</h3>

            <div class="flavor-tags" id="flavor-tags">
                <span class="flavor-tag">Balanced Acidity</span>
                <span class="flavor-tag">Caramel Sweetness</span>
                <span class="flavor-tag">Medium Body</span>
                <span class="flavor-tag">Chocolate Notes</span>
            </div>

            <ul class="recommendation-list" id="recommendations">
                <li class="recommendation-item">Medium-light roast profile maintains origin character while developing sweetness.</li>
                <li class="recommendation-item">First crack at 8:30 allows for good development time (3:00).</li>
                <li class="recommendation-item">Recommended for filter brewing methods (pour-over, drip).</li>
            </ul>
        </div>

        <div class="comparison-section">
            <h3 class="analysis-title">Compare Roast Levels</h3>
            <p style="margin-bottom: 15px;">Select roast levels to compare side-by-side:</p>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="compare-btn" onclick="compareRoasts(['light', 'medium', 'dark'])">Light vs Medium vs Dark</button>
                <button class="compare-btn" onclick="compareRoasts(['medium-light', 'medium-dark'])">Medium-Light vs Medium-Dark</button>
                <button class="compare-btn" onclick="exportRoastCurve()">Export Current Curve</button>
            </div>
            <div id="comparison-results" style="margin-top: 15px;"></div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('roast-canvas');
        const ctx = canvas.getContext('2d');

        const roastProfiles = {
            'light': {
                endTemp: 205,
                totalTime: 10.5,
                fcTime: 8.0,
                devTime: 2.5,
                agtron: 75,
                flavors: ['Bright Acidity', 'Floral Notes', 'Tea-like Body', 'Origin Character'],
                recs: [
                    'Light roast emphasizes origin terroir and acidity',
                    'Best for pour-over and cold brew methods',
                    'Preserve delicate flavor compounds'
                ]
            },
            'medium-light': {
                endTemp: 210,
                totalTime: 11.5,
                fcTime: 8.5,
                devTime: 3.0,
                agtron: 65,
                flavors: ['Balanced Acidity', 'Caramel Sweetness', 'Medium Body', 'Chocolate Notes'],
                recs: [
                    'Medium-light roast maintains origin character while developing sweetness',
                    'First crack at 8:30 allows for good development time (3:00)',
                    'Recommended for filter brewing methods (pour-over, drip)'
                ]
            },
            'medium': {
                endTemp: 215,
                totalTime: 12.0,
                fcTime: 8.5,
                devTime: 3.5,
                agtron: 55,
                flavors: ['Moderate Acidity', 'Rich Sweetness', 'Full Body', 'Nutty & Chocolate'],
                recs: [
                    'Medium roast balances acidity and body perfectly',
                    'Versatile for most brewing methods',
                    'Ideal for espresso and drip coffee'
                ]
            },
            'medium-dark': {
                endTemp: 220,
                totalTime: 13.0,
                fcTime: 9.0,
                devTime: 4.0,
                agtron: 45,
                flavors: ['Low Acidity', 'Dark Chocolate', 'Heavy Body', 'Spicy Notes'],
                recs: [
                    'Medium-dark develops roast character',
                    'Approaching second crack creates oils',
                    'Excellent for espresso and milk-based drinks'
                ]
            },
            'dark': {
                endTemp: 225,
                totalTime: 14.0,
                fcTime: 9.0,
                devTime: 5.0,
                agtron: 35,
                flavors: ['Minimal Acidity', 'Bitter-Sweet', 'Heavy Body', 'Charcoal & Smoke'],
                recs: [
                    'Dark roast emphasizes roast flavor over origin',
                    'High oil content, shiny beans',
                    'Traditional for espresso, French press'
                ]
            }
        };

        let currentProfile = 'medium-light';

        // Preset buttons
        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
                e.target.classList.add('active');
                currentProfile = e.target.dataset.roast;
                updateDisplay();
            });
        });

        function updateDisplay() {
            const profile = roastProfiles[currentProfile];

            // Update metrics
            document.getElementById('end-temp').textContent = `${profile.endTemp}Â°C`;
            const mins = Math.floor(profile.totalTime);
            const secs = Math.round((profile.totalTime % 1) * 60);
            document.getElementById('total-time').textContent = `${mins}:${secs.toString().padStart(2, '0')}`;

            const avgROR = (profile.endTemp - 20) / profile.totalTime;
            document.getElementById('avg-ror').textContent = `${avgROR.toFixed(1)}Â°/min`;
            document.getElementById('agtron').textContent = profile.agtron;

            // Update phases
            const fcMins = Math.floor(profile.fcTime);
            const fcSecs = Math.round((profile.fcTime % 1) * 60);
            const devMins = Math.floor(profile.devTime);
            const devSecs = Math.round((profile.devTime % 1) * 60);

            document.getElementById('drying-time').textContent = '0:00 - 4:00';
            document.getElementById('maillard-time').textContent = `4:00 - ${fcMins}:${fcSecs.toString().padStart(2, '0')}`;
            document.getElementById('fc-time').textContent = `${fcMins}:${fcSecs.toString().padStart(2, '0')}`;
            document.getElementById('dev-time').textContent = `${fcMins}:${fcSecs.toString().padStart(2, '0')} - ${mins}:${secs.toString().padStart(2, '0')}`;

            // Update flavors
            const flavorTags = document.getElementById('flavor-tags');
            flavorTags.innerHTML = profile.flavors.map(f => `<span class="flavor-tag">${f}</span>`).join('');

            // Update recommendations
            const recsList = document.getElementById('recommendations');
            recsList.innerHTML = profile.recs.map(r => `<li class="recommendation-item">${r}</li>`).join('');

            drawRoastCurve();
        }

        function drawRoastCurve() {
            const profile = roastProfiles[currentProfile];
            const width = canvas.width;
            const height = canvas.height;
            const margin = 80;
            const plotWidth = width - margin * 2;
            const plotHeight = height - margin * 2;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Background
            ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
            ctx.fillRect(margin, margin, plotWidth, plotHeight);

            // Grid
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.lineWidth = 1;

            // Vertical grid (time)
            for (let t = 0; t <= profile.totalTime; t += 2) {
                const x = margin + (t / profile.totalTime) * plotWidth;
                ctx.beginPath();
                ctx.moveTo(x, margin);
                ctx.lineTo(x, height - margin);
                ctx.stroke();
            }

            // Horizontal grid (temp)
            for (let temp = 0; temp <= 240; temp += 20) {
                const y = height - margin - (temp / 240) * plotHeight;
                ctx.beginPath();
                ctx.moveTo(margin, y);
                ctx.lineTo(width - margin, y);
                ctx.stroke();
            }

            // Generate roast curve
            const points = [];
            const numPoints = 100;

            for (let i = 0; i <= numPoints; i++) {
                const t = (i / numPoints) * profile.totalTime;
                let temp = calculateTemperature(t, profile);
                points.push({ t, temp });
            }

            // Draw curve
            ctx.strokeStyle = '#FFD700';
            ctx.lineWidth = 4;
            ctx.beginPath();
            points.forEach((point, i) => {
                const x = margin + (point.t / profile.totalTime) * plotWidth;
                const y = height - margin - (point.temp / 240) * plotHeight;
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            });
            ctx.stroke();

            // Draw phase regions
            drawPhaseRegion(0, 4, 'rgba(100, 150, 255, 0.1)', 'Drying');
            drawPhaseRegion(4, profile.fcTime, 'rgba(255, 200, 100, 0.1)', 'Maillard');
            drawPhaseRegion(profile.fcTime, profile.totalTime, 'rgba(255, 100, 100, 0.1)', 'Development');

            // Draw first crack marker
            const fcX = margin + (profile.fcTime / profile.totalTime) * plotWidth;
            ctx.setLineDash([5, 5]);
            ctx.strokeStyle = '#FF5722';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(fcX, margin);
            ctx.lineTo(fcX, height - margin);
            ctx.stroke();
            ctx.setLineDash([]);

            // FC label
            ctx.fillStyle = '#FF5722';
            ctx.font = 'bold 14px SF Pro Display, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('First Crack', fcX, margin - 10);

            // Draw axes
            ctx.strokeStyle = '#FFD700';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, height - margin);
            ctx.lineTo(width - margin, height - margin);
            ctx.stroke();

            // Labels
            ctx.fillStyle = '#FFD700';
            ctx.font = 'bold 16px SF Pro Display, sans-serif';
            ctx.textAlign = 'center';

            // X-axis label
            ctx.fillText('Time (minutes)', width / 2, height - 10);

            // X-axis ticks
            for (let t = 0; t <= Math.ceil(profile.totalTime); t += 2) {
                const x = margin + (t / profile.totalTime) * plotWidth;
                ctx.fillText(t, x, height - margin + 30);
            }

            // Y-axis label
            ctx.save();
            ctx.translate(20, height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('Temperature (Â°C)', 0, 0);
            ctx.restore();

            // Y-axis ticks
            ctx.textAlign = 'right';
            for (let temp = 0; temp <= 240; temp += 40) {
                const y = height - margin - (temp / 240) * plotHeight;
                ctx.fillText(temp, margin - 15, y + 5);
            }
        }

        function drawPhaseRegion(startTime, endTime, color, label) {
            const profile = roastProfiles[currentProfile];
            const margin = 80;
            const plotWidth = canvas.width - margin * 2;
            const plotHeight = canvas.height - margin * 2;

            const x1 = margin + (startTime / profile.totalTime) * plotWidth;
            const x2 = margin + (endTime / profile.totalTime) * plotWidth;

            ctx.fillStyle = color;
            ctx.fillRect(x1, margin, x2 - x1, plotHeight);
        }

        function calculateTemperature(t, profile) {
            // Simplified roast curve model
            const totalTime = profile.totalTime;
            const endTemp = profile.endTemp;
            const fcTime = profile.fcTime;

            if (t === 0) return 20; // Ambient temp

            // Drying phase (0-4 min): slow heat up
            if (t < 4) {
                return 20 + (100 * (t / 4));
            }

            // Maillard phase (4-FC): accelerating
            if (t < fcTime) {
                const progress = (t - 4) / (fcTime - 4);
                return 120 + (70 * Math.pow(progress, 0.8));
            }

            // Development phase (FC-end): controlled
            const progress = (t - fcTime) / (totalTime - fcTime);
            return 190 + ((endTemp - 190) * progress);
        }

        // Initialize
        updateDisplay();

        // Comparison functionality
        function compareRoasts(roasts) {
            const results = document.getElementById('comparison-results');
            let html = '<table style="width:100%; margin-top: 15px; border-collapse: collapse;">';
            html += '<tr style="background: rgba(255, 215, 0, 0.1);"><th style="padding: 10px; border: 1px solid rgba(255,215,0,0.3);">Roast Level</th><th style="padding: 10px; border: 1px solid rgba(255,215,0,0.3);">End Temp</th><th style="padding: 10px; border: 1px solid rgba(255,215,0,0.3);">Total Time</th><th style="padding: 10px; border: 1px solid rgba(255,215,0,0.3);">Dev Time</th><th style="padding: 10px; border: 1px solid rgba(255,215,0,0.3);">Agtron</th></tr>';

            roasts.forEach(roast => {
                const profile = roastProfiles[roast];
                const mins = Math.floor(profile.totalTime);
                const secs = Math.round((profile.totalTime % 1) * 60);
                const devMins = Math.floor(profile.devTime);
                const devSecs = Math.round((profile.devTime % 1) * 60);

                html += `<tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <td style="padding: 10px; border: 1px solid rgba(255,215,0,0.3);"><strong>${roast.toUpperCase()}</strong></td>
                    <td style="padding: 10px; border: 1px solid rgba(255,215,0,0.3);">${profile.endTemp}Â°C</td>
                    <td style="padding: 10px; border: 1px solid rgba(255,215,0,0.3);">${mins}:${secs.toString().padStart(2, '0')}</td>
                    <td style="padding: 10px; border: 1px solid rgba(255,215,0,0.3);">${devMins}:${devSecs.toString().padStart(2, '0')}</td>
                    <td style="padding: 10px; border: 1px solid rgba(255,215,0,0.3);">${profile.agtron}</td>
                </tr>`;
            });

            html += '</table>';
            results.innerHTML = html;
        }

        function exportRoastCurve() {
            const link = document.createElement('a');
            link.download = `roast-profile-${currentProfile}.png`;
            link.href = canvas.toDataURL();
            link.click();
        }
    </script>
</body>
</html>
